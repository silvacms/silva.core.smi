<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="silva">

<tal:block>
  <form method="post"
    action="."
    tal:attributes="action request.URL"
    tal:condition="content and view.set_names">
    <!-- tal:attributes="class python: template.id != 'tab_metadata' and 'sublisting' or nothing" -->
    <input type="hidden" name="returntotab" tal:attributes="value string:XXX"/>
    <table class="listing"
      tal:attributes="class view.is_container and 'listing listing-metadata' or 'listing listing-metadata-container'">
      <thead>
        <tr>
          <td class="top" colspan="4">
            <h2 metal:define-slot="table_title">
              <img tal:attributes="src view.get_icon_url()" />
              <tal:block content="view.title" i18n:name="title" />
              &#xab;<span tal:replace="content.get_title()" />&#xbb;
            </h2>
          </td>
        </tr>
      </thead>
      <tbody>
        <tal:block repeat="set_name view.set_names">
          <tal:block define="set_errors path:view/errors/?set_name | nothing">
            <tr class="divider"
              tal:condition="not:repeat['set_name'].start">
              <td colspan="3"
                tal:attributes="class view.is_container and 'separator separator-container' or 'separator'">
              </td>
            </tr>
            <tr class="top-controls">
              <td colspan="3">
                <h3 tal:define="
                  set view.get_set_title(set_name);
                  label set == 'silva-extra' and 'silva-meta' or set;
                  ">
                  <tal:i18n i18n:translate="">metadata set</tal:i18n> &#xab;<tal:block replace="label" />&#xbb;
                </h3>
              </td>
            </tr>
            <tr>
              <th width="20%"
                i18n:translate="">
                element
              </th>
              <th i18n:translate=""
                width="50%">
                content
              </th>
              <th i18n:translate="">
                acquired content
              </th>
            </tr>
            <tal:block repeat="element_name view.get_element_names(set_name)">
              <tal:block define="
                element_error path:view/errors/?set_name/?element_name | nothing;
                iterate repeat['element_name'].odd;
                identifier (set_name, element_name)
                ">
                <tal:block
                  condition="view.is_element_hidden(*identifier)"
                  replace="structure python: view.render_element(*identifier)"
                />
                <tr tal:condition="not view.is_element_hidden(*identifier)"
                  tal:attributes="class element_error and 'alert' or iterate and 'odd' or 'even';">
                  <tal:block replace="nothing">
                    ___ element designator column ___
                  </tal:block>
                  <td class="designator">
                    <span class="matchlabel"
                          tal:omit-tag="view.is_element_editable(*identifier)">
                      <label tal:content="view.get_element_title(*identifier)"
                        tal:attributes="for view.html_id(*identifier)"
                         tal:omit-tag="python:not (view.is_element_editable(*identifier) and view.html_id(*identifier))"
                        i18n:translate="">
                        Element name
                      </label><span class="required"
                        tal:condition="view.is_element_required(*identifier)"> * </span>
                    </span>
                    <p tal:content="structure view.get_element_description(*identifier)"
                      i18n:translate="">
                      Element description
                    </p>
                  </td>
                  <tal:block replace="nothing">
                    ___ element widget column ___
                  </tal:block>
                  <td class="field">
                    <span class="error"
                      tal:condition="element_error"
                      tal:content="element_error">
                      Error message
                    </span>
                    <tal:input  
                      tal:condition="view.is_element_editable(*identifier) or not view.is_element_acquired(*identifier)"
                      tal:content="structure view.render_element(*identifier)">
                      element edit widget
                    </tal:input>
                  </td>
                  <tal:block replace="nothing">
                    ___ element acquired value column ___
                  </tal:block>
                  <td>
                    <tal:block
                      condition="view.is_element_acquired(*identifier)"
                      replace="structure view.render_element_view(*identifier)" />
                    <sup tal:condition="view.is_element_acquireable(*identifier)">
                      &#8224;
                    </sup>
                    <tal:block condition="not: view.is_element_acquired(*identifier)">
                      &nbsp;
                    </tal:block>
                  </td>
                </tr>
              </tal:block>
            </tal:block>
          </tal:block>
          <tr tal:condition="set_name != 'silva-content'">
            <th i18n:translate="">
              * required
            </th>
            <th>
              <tal:if tal:condition="set_name == 'silva-extra'"
                i18n:translate="">
                day / month / year &nbsp;(23:59)
              </tal:if>&nbsp;
            </th>
            <th i18n:translate="">
              &#8224; acquireable
            </th>
          </tr>
          <tr class="controls" tal:condition="view.edit">
            <td class="align-right" colspan="3">
              <div class="actions"
                   tal:condition="view.actionWidgets">
                <div class="action" tal:repeat="widget view.actionWidgets">
                  <tal:widget tal:content="structure widget.render()" />
                </div>
              </div>
            </td>
          </tr>
        </tal:block>
      </tbody>
    </table>
  </form>
</tal:block>
</html>
